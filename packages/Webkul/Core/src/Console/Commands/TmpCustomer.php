<?php

namespace Webkul\Core\Console\Commands;

use Illuminate\Console\Command;
use Webkul\Lead\Models\TmpCustomer as ModelTmpCustomer;
use Webkul\Contact\Repositories\PersonRepository;
use Webkul\User\Repositories\UserRepository;
use Webkul\Lead\Repositories\LeadRepository;
use Webkul\User\Models\User;

class TmpCustomer extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'tmp-customers';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Test insert tmp customers';

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct(
        protected PersonRepository $personRepository,
        protected UserRepository $userRepository,
        protected LeadRepository $leadRepository,
    ) {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {
        # set default user vì hệ thống này có phần log activity nên bắt buộc phải có auth(), chưa tìm cách tắt đc log khi chạy command
        $user = User::where('email', 'thanhan1507@gmail.com')->first();
        auth()->login($user);
        $userId = $user->id;

        # import data mẫu từ API (chỗ này do đang test nên lấy data mẫu từ api chứ chưa call trực tiếp)
        // $data = self::tmpData();
        // foreach ($data as $item) {
        //     $model = new ModelTmpCustomer();
        //     $model->id_kiotviet = $item->id;
        //     $model->code = $item->code;
        //     $model->name = $item->name;
        //     $model->branchId = $item->branchId;
        //     $model->locationName = $item->locationName;
        //     $model->wardName = $item->wardName;
        //     $model->type = $item->type;
        //     $model->organization = $item->organization;
        //     $model->debt = $item->debt;
        //     $model->totalInvoiced = $item->totalInvoiced;
        //     $model->totalRevenue = $item->totalRevenue;
        //     $model->totalPoint = $item->totalPoint;
        //     $model->save();
        // }
        // exit();

        # convert sang bảng leads tương ứng với is_customer = true (khách hàng hiện hữu)
        $data = ModelTmpCustomer::all();
        foreach ($data as $item) {
            $params = [
                'title' => $item->name,
                'lead_value' => $item->totalRevenue,
                'lead_source_id' => 2,
                'lead_type_id' => 2,
                'person' => [
                    'id' => null,
                    'name' => $item->name,
                    'emails' => [
                        [
                            'value' => $item->id_kiotviet . '@gmail.com',
                            'label' => 'work'
                        ]
                    ],
                ],
                'entity_type' => 'leads',
                'status' => 1,
                'is_customer' => 1,
            ];
            $customer = $this->leadRepository->create($params);
            echo 'done->' . $item->name . "; \n";
        }
    }

    public static function tmpData()
    {
        $rs = '[{"id":6179004,"code":"KH000174","name":"Nguyễn Tiến Dũng","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2020-09-30T14:34:07.1800000","createdDate":"2020-09-30T14:34:04.5670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":252000.0000,"totalRevenue":252000.0000,"totalPoint":0},{"id":6362413,"code":"KH000184","name":"Duy Trần","contactNumber":"","address":"","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","email":"","modifiedDate":"2020-10-29T10:46:06.6200000","createdDate":"2020-10-08T09:57:13.2800000","type":0,"organization":"","taxCode":"","comments":"","debt":0.0000,"totalInvoiced":140000.0000,"totalRevenue":140000.0000,"totalPoint":0,"rewardPoint":0},{"id":7568855,"code":"KH000222","name":"Anh Lee","contactNumber":"0961135588/0971135588","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2020-11-26T15:30:58.4800000","createdDate":"2020-11-26T15:30:46.8070000","type":0,"organization":"","debt":0.0000,"totalInvoiced":80000.0000,"totalRevenue":80000.0000,"totalPoint":0},{"id":7656467,"code":"KH000224","name":"Chị Phượng- Vin OCP s2.19","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2020-11-30T10:28:15.9400000","createdDate":"2020-11-30T10:28:14.4870000","type":0,"organization":"","debt":0.0000,"totalInvoiced":300000.0000,"totalRevenue":300000.0000,"totalPoint":0},{"id":7764080,"code":"KH000229","name":"Cao Thành Trung- Ngọc Động, Đa tốn","contactNumber":"0","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2020-12-04T09:22:29.6470000","createdDate":"2020-12-04T09:22:22.7870000","type":0,"organization":"","debt":0.0000,"totalInvoiced":285000.0000,"totalRevenue":285000.0000,"totalPoint":0},{"id":7786336,"code":"KH000232","name":"Chị Thụy-Vin OCP","contactNumber":"09747941287","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2020-12-05T09:55:24.4670000","createdDate":"2020-12-05T09:55:15.6130000","type":0,"organization":"","debt":0.0000,"totalInvoiced":420000.0000,"totalRevenue":420000.0000,"totalPoint":0},{"id":7910536,"code":"KH000241","name":"Nguyễn Anh Tuấn","contactNumber":"096983586","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2020-12-10T22:11:57.4530000","createdDate":"2020-12-10T22:11:51.3100000","type":0,"organization":"","debt":0.0000,"totalInvoiced":230000.0000,"totalRevenue":230000.0000,"totalPoint":0},{"id":8696758,"code":"KH000271","name":"Cao Minh","gender":false,"contactNumber":"09079525195","address":"Cổ Bi","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-01-14T12:16:43.8200000","createdDate":"2021-01-14T12:16:39.0830000","type":0,"organization":"","debt":0.0000,"totalInvoiced":47500.0000,"totalRevenue":47500.0000,"totalPoint":0},{"id":8818395,"code":"KH000274","name":"Chị Nhân","contactNumber":"000000000","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-01-28T17:21:57.9470000","createdDate":"2021-01-19T11:29:45.1400000","type":0,"organization":"","debt":0.0000,"totalInvoiced":255000.0000,"totalRevenue":255000.0000,"totalPoint":0},{"id":9303825,"code":"KH000291","name":"Khách thuê lồng hàng ko size nhỏ","contactNumber":"00000000000000","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-02-03T18:18:52.2600000","createdDate":"2021-02-03T09:57:56.9230000","type":0,"organization":"","debt":0.0000,"totalInvoiced":0,"totalRevenue":0,"totalPoint":0},{"id":9412360,"code":"KH000296","name":"Chị Hương Tươi","contactNumber":"0000000","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-02-22T21:26:20.4570000","createdDate":"2021-02-08T09:44:36.7230000","type":0,"organization":"","debt":0.0000,"totalInvoiced":510000.0000,"totalRevenue":510000.0000,"totalPoint":0},{"id":9992681,"code":"KH000459","name":"Anh Tuấn - ac Hà","gender":true,"retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-03-12T21:43:33.8400000","createdDate":"2021-03-12T21:43:27.3770000","type":0,"organization":"","debt":0.0000,"totalInvoiced":130000.0000,"totalRevenue":130000.0000,"totalPoint":0},{"id":10070820,"code":"KH000485","name":"Chị Bùi Thị Nhung-0354967722","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-03-16T15:55:36.3670000","createdDate":"2021-03-16T15:55:11.2830000","type":0,"organization":"","debt":0.0000,"totalInvoiced":270000.0000,"totalRevenue":270000.0000,"totalPoint":2,"rewardPoint":2},{"id":10180475,"code":"KH000511","name":"Chị Thúy-Đa Tốn","gender":false,"contactNumber":"09729711626","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-03-22T09:54:24.7000000","createdDate":"2021-03-22T09:54:24.7000000","type":0,"organization":"","comments":"đặt lồng chuột","debt":0,"totalInvoiced":0,"totalRevenue":0,"totalPoint":0},{"id":10331901,"code":"KH000537","name":"Chị Thái-Vin OCP S2.07","contactNumber":"","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-03-29T18:10:51.5230000","createdDate":"2021-03-29T18:10:06.2130000","type":0,"organization":"","debt":0.0000,"totalInvoiced":210000.0000,"totalRevenue":210000.0000,"totalPoint":2,"rewardPoint":2},{"id":11040533,"code":"KH000613","name":"Anh Hoàng Minh Đức-Đông Dư","contactNumber":"03975276060","address":"","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-05-06T17:00:40.8430000","createdDate":"2021-05-06T17:00:31.5600000","type":0,"organization":"","taxCode":"","comments":"","debt":0.0000,"totalInvoiced":340000.0000,"totalRevenue":340000.0000,"totalPoint":3,"rewardPoint":3},{"id":11064257,"code":"KH000619","name":"em huyền","gender":false,"contactNumber":"03922840841","address":"đào nguyên","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","email":"","modifiedDate":"2021-05-08T08:02:28.8000000","createdDate":"2021-05-08T08:00:54.8700000","type":0,"organization":"","debt":0.0000,"totalInvoiced":30000.0000,"totalRevenue":30000.0000,"totalPoint":0},{"id":11113937,"code":"KH000637","name":"quỳnh hoa VIn OCP S2.18","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-05-10T21:22:18.0100000","createdDate":"2021-05-10T21:22:10.6770000","type":0,"organization":"","debt":0.0000,"totalInvoiced":490000.0000,"totalRevenue":490000.0000,"totalPoint":4,"rewardPoint":4},{"id":11289760,"code":"KH000654","name":"chị ngân","gender":false,"retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-05-20T17:55:20.7670000","createdDate":"2021-05-20T17:55:14.9670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":450000.0000,"totalRevenue":450000.0000,"totalPoint":4,"rewardPoint":4},{"id":11292388,"code":"KH000657","name":"Trịnh Thu Thảo-Văn Đức","contactNumber":"0888887086s","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-05-20T21:16:44.3070000","createdDate":"2021-05-20T21:16:29.2070000","type":0,"organization":"","debt":0.0000,"totalInvoiced":40000.0000,"totalRevenue":40000.0000,"totalPoint":0},{"id":11397025,"code":"KH000675","name":"Nhà bán cơm An Đào A","contactNumber":"00000000077","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-05-27T10:17:36.3300000","createdDate":"2021-05-27T10:17:30.7970000","type":0,"organization":"","debt":280000.0000,"totalInvoiced":780000.0000,"totalRevenue":780000.0000,"totalPoint":1,"rewardPoint":1},{"id":11580451,"code":"KH000713","name":"Ngọc Thủy-Dương Xá","contactNumber":"000000000000","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-06-06T17:19:57.8430000","createdDate":"2021-06-06T17:20:07.1670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":500000.0000,"totalRevenue":500000.0000,"totalPoint":1,"rewardPoint":1},{"id":12286454,"code":"KH000879","name":"A khanh","gender":true,"contactNumber":"","address":"đa tốn","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","email":"","modifiedDate":"2021-07-21T19:12:15.3230000","createdDate":"2021-07-21T19:12:13.6630000","type":0,"organization":"","taxCode":"","comments":"","debt":0.0000,"totalInvoiced":4922000.0000,"totalRevenue":4922000.0000,"totalPoint":0,"rewardPoint":0},{"id":12468782,"code":"KH000895","name":"Khách An Đào C","contactNumber":"0000000000000001","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-07T07:31:59.7430000","createdDate":"2021-08-06T09:09:02.3170000","type":0,"organization":"","debt":0.0000,"totalInvoiced":90000.0000,"totalRevenue":90000.0000,"totalPoint":0},{"id":12579988,"code":"KH000905","name":"Chị Nhung-An Đào B","contactNumber":"0985198255","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-13T07:30:20.9930000","createdDate":"2021-08-13T07:30:15.4900000","type":0,"organization":"","debt":0.0000,"totalInvoiced":250000.0000,"totalRevenue":250000.0000,"totalPoint":2,"rewardPoint":2},{"id":10335587,"code":"KH000541","name":"KIM CHI","gender":false,"contactNumber":"0366900333","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-13T07:36:32.1930000","createdDate":"2021-03-29T21:57:58.4270000","type":0,"organization":"","debt":0.0000,"totalInvoiced":815000.0000,"totalRevenue":815000.0000,"totalPoint":5,"rewardPoint":5},{"id":12601692,"code":"KH000908","name":"anh huy","contactNumber":"0762026200","address":"VHOP","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-15T20:06:15.8000000","createdDate":"2021-08-14T19:56:46.3330000","type":0,"organization":"","debt":0.0000,"totalInvoiced":0,"totalRevenue":0,"totalPoint":0,"rewardPoint":0},{"id":12650138,"code":"KH000916","name":"Nguyễn Tư Phúc","contactNumber":"0968313773","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-19T08:40:08.9470000","createdDate":"2021-08-19T08:39:55.5670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":720000.0000,"totalRevenue":720000.0000,"totalPoint":7,"rewardPoint":7},{"id":12658782,"code":"KH000917","name":"c giang","contactNumber":"0978828636","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-19T18:24:04.8570000","createdDate":"2021-08-19T18:21:18.5970000","type":0,"organization":"","debt":0.0000,"totalInvoiced":380000.0000,"totalRevenue":380000.0000,"totalPoint":3,"rewardPoint":3},{"id":12658928,"code":"KH000918","name":"Anh ở Phúc Lợi","contactNumber":"0962789929","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-19T18:39:17.3530000","createdDate":"2021-08-19T18:39:09.1630000","type":0,"organization":"","debt":0.0000,"totalInvoiced":440000.0000,"totalRevenue":440000.0000,"totalPoint":0},{"id":12670826,"code":"KH000919","name":"anh minh VHOP S210","contactNumber":"0921506666","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-20T19:19:58.6700000","createdDate":"2021-08-20T19:19:53.1900000","type":0,"organization":"","debt":0.0000,"totalInvoiced":310000.0000,"totalRevenue":310000.0000,"totalPoint":3,"rewardPoint":3},{"id":12673946,"code":"KH000920","name":"Chị Huế-Đào Xuyên","contactNumber":"0358219692","address":"","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","email":"","modifiedDate":"2021-08-21T08:38:01.6230000","createdDate":"2021-08-21T08:37:17.9530000","type":0,"organization":"","taxCode":"","comments":"","debt":0.0000,"totalInvoiced":660000.0000,"totalRevenue":660000.0000,"totalPoint":6,"rewardPoint":6},{"id":12707801,"code":"KH000924","name":"Chị Hoàng Anh-Vin OCP S2.17","contactNumber":"0978812041","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-24T16:56:21.9870000","createdDate":"2021-08-24T16:52:59.9600000","type":0,"organization":"","debt":0.0000,"totalInvoiced":240000.0000,"totalRevenue":240000.0000,"totalPoint":0},{"id":12733907,"code":"KH000928","name":"Chủ cún poodle trắng","contactNumber":"0965100859","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-27T19:18:00.1830000","createdDate":"2021-08-27T19:17:58.0100000","type":0,"organization":"","debt":0.0000,"totalInvoiced":400000.0000,"totalRevenue":400000.0000,"totalPoint":4,"rewardPoint":4},{"id":12768175,"code":"KH000933","name":"Linh-38 An Đào A","contactNumber":"0982118498","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-08-31T17:59:35.0330000","createdDate":"2021-08-31T17:59:30.0000000","type":0,"organization":"","debt":0.0000,"totalInvoiced":155000.0000,"totalRevenue":155000.0000,"totalPoint":1,"rewardPoint":1},{"id":12798214,"code":"KH000934","name":"Phương-Vin S1.01","contactNumber":"0378035096","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-03T20:35:12.3500000","createdDate":"2021-09-03T20:33:17.4870000","type":0,"organization":"","debt":0.0000,"totalInvoiced":330000.0000,"totalRevenue":330000.0000,"totalPoint":3,"rewardPoint":3},{"id":12650011,"code":"KH000914","name":"Anh ở Bắc Ninh lấy thuốc nhỏ tai","contactNumber":"0356292528","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-05T22:00:21.9370000","createdDate":"2021-08-19T08:29:19.6600000","type":0,"organization":"","debt":0.0000,"totalInvoiced":210000.0000,"totalRevenue":210000.0000,"totalPoint":2,"rewardPoint":2},{"id":11416402,"code":"KH000680","name":"anh tuyền-ân thi hưng yên","gender":true,"contactNumber":"0852615555","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-05T22:01:02.0200000","createdDate":"2021-05-28T13:02:12.8770000","type":0,"organization":"","debt":0.0000,"totalInvoiced":2920000.0000,"totalRevenue":2920000.0000,"totalPoint":9,"rewardPoint":9},{"id":12650086,"code":"KH000915","name":"Anh ở Hải Dương láy thuốc tẩy giun","contactNumber":"0868125386","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-05T22:01:28.8670000","createdDate":"2021-08-19T08:35:00.7600000","type":0,"organization":"","debt":0.0000,"totalInvoiced":400000.0000,"totalRevenue":400000.0000,"totalPoint":4,"rewardPoint":4},{"id":12883632,"code":"KH000936","name":"chú phong","contactNumber":"0834423202","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-11T09:10:02.6370000","createdDate":"2021-09-11T09:09:48.6000000","type":0,"organization":"","debt":0.0000,"totalInvoiced":30000.0000,"totalRevenue":30000.0000,"totalPoint":0},{"id":12885243,"code":"KH000938","name":"Anh Đạt-Vin OCP S1.11","contactNumber":"0376635438","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-11T11:07:45.9800000","createdDate":"2021-09-11T11:06:05.6930000","type":0,"organization":"","debt":0.0000,"totalInvoiced":700000.0000,"totalRevenue":700000.0000,"totalPoint":2,"rewardPoint":2},{"id":12890460,"code":"KH000939","name":"nguyệt minh","contactNumber":"0904161623","address":"85 an đào B","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-11T18:18:44.4800000","createdDate":"2021-09-11T18:18:13.6570000","type":0,"organization":"","debt":0.0000,"totalInvoiced":80000.0000,"totalRevenue":80000.0000,"totalPoint":0},{"id":12900327,"code":"KH000942","name":"Linh-Cửu Việt 1","contactNumber":"0867612760","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-12T18:36:03.6970000","createdDate":"2021-09-12T18:35:29.7770000","type":0,"organization":"","debt":0.0000,"totalInvoiced":280000.0000,"totalRevenue":280000.0000,"totalPoint":1,"rewardPoint":1},{"id":9791954,"code":"KH000402","name":"Minh Anh-VIN OCP S2.03","contactNumber":"0816612323","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-13T17:47:05.0400000","createdDate":"2021-03-03T16:13:39.4300000","type":0,"organization":"","debt":25000.0000,"totalInvoiced":1025000.0000,"totalRevenue":1025000.0000,"totalPoint":9,"rewardPoint":9},{"id":12928656,"code":"KH000948","name":"Thư-Vin OCP S202","contactNumber":"0399401869","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-15T07:44:57.2500000","createdDate":"2021-09-15T07:44:45.0370000","type":0,"organization":"","debt":10000.0000,"totalInvoiced":130000.0000,"totalRevenue":130000.0000,"totalPoint":1,"rewardPoint":1},{"id":12955366,"code":"KH000957","name":"Van 61","contactNumber":"0399636279","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-17T10:25:22.8270000","createdDate":"2021-09-17T10:25:19.4000000","type":0,"organization":"","debt":0.0000,"totalInvoiced":430000.0000,"totalRevenue":430000.0000,"totalPoint":0},{"id":12961419,"code":"KH000958","name":"a quang","contactNumber":"0912424142","address":"VHOP","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-17T17:10:34.2500000","createdDate":"2021-09-17T17:10:31.8670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":210000.0000,"totalRevenue":210000.0000,"totalPoint":2,"rewardPoint":2},{"id":12973663,"code":"KH000960","name":"nhật anh VHOP","contactNumber":"0967910029","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-18T17:30:55.6930000","createdDate":"2021-09-18T17:30:54.1500000","type":0,"organization":"","debt":0.0000,"totalInvoiced":130000.0000,"totalRevenue":130000.0000,"totalPoint":0},{"id":13001284,"code":"KH000967","name":"Cô S2-18 nuôi mèo","contactNumber":"+84986193564","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-20T21:56:33.8030000","createdDate":"2021-09-20T21:56:29.2730000","type":0,"organization":"","debt":0.0000,"totalInvoiced":120000.0000,"totalRevenue":120000.0000,"totalPoint":1,"rewardPoint":1},{"id":10272128,"code":"KH000529","name":"a chức","contactNumber":"0969580169","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-20T22:21:22.5530000","createdDate":"2021-03-26T18:13:53.0900000","type":0,"organization":"","debt":0.0000,"totalInvoiced":410000.0000,"totalRevenue":410000.0000,"totalPoint":4,"rewardPoint":4},{"id":13016163,"code":"KH000969","name":"Chủ poodle chữa viêm da","contactNumber":"0912217435","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-22T07:50:33.7530000","createdDate":"2021-09-22T07:50:32.1630000","type":0,"organization":"","debt":0.0000,"totalInvoiced":1000000.0000,"totalRevenue":1000000.0000,"totalPoint":6,"rewardPoint":6},{"id":9349740,"code":"KH000293","name":"chị Khanh Le","contactNumber":"0000000000000","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-22T09:12:35.7830000","createdDate":"2021-02-05T09:03:26.0530000","type":0,"organization":"","debt":0.0000,"totalInvoiced":0,"totalRevenue":0,"totalPoint":0,"rewardPoint":0},{"id":13031949,"code":"KH000970","name":"Chị Hương - S2.10","gender":false,"contactNumber":"0333432711","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-23T11:17:12.1800000","createdDate":"2021-09-23T11:16:04.8200000","type":0,"organization":"","debt":0.0000,"totalInvoiced":670000.0000,"totalRevenue":670000.0000,"totalPoint":6,"rewardPoint":6},{"id":13034901,"code":"KH000971","name":"anh thành","contactNumber":"09184848372","address":"đặng xá","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-23T14:44:28.4530000","createdDate":"2021-09-23T14:44:12.6530000","type":0,"organization":"","debt":0.0000,"totalInvoiced":110000.0000,"totalRevenue":110000.0000,"totalPoint":1,"rewardPoint":1},{"id":12624782,"code":"KH000912","name":"chị nhật lệ","contactNumber":"0386921995","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-24T16:41:15.1870000","createdDate":"2021-08-16T19:44:49.4430000","type":0,"organization":"","debt":0.0000,"totalInvoiced":505000.0000,"totalRevenue":505000.0000,"totalPoint":4,"rewardPoint":4},{"id":13050642,"code":"KH000976","name":"Chi-Vin OCP S1.12","contactNumber":"0986075210","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-24T19:07:09.3470000","createdDate":"2021-09-24T19:04:23.9370000","type":0,"organization":"","debt":0.0000,"totalInvoiced":618000.0000,"totalRevenue":618000.0000,"totalPoint":6,"rewardPoint":6},{"id":12572200,"code":"KH000903","name":"Anh Bình- Đặng Xá","contactNumber":"0978266257","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-25T21:46:54.3130000","createdDate":"2021-08-12T12:02:18.4970000","type":0,"organization":"","debt":0.0000,"totalInvoiced":1380000.0000,"totalRevenue":1380000.0000,"totalPoint":11,"rewardPoint":11},{"id":13045278,"code":"KH000974","name":"bằng","contactNumber":"0335117818","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-27T13:26:41.8330000","createdDate":"2021-09-24T12:18:34.1530000","type":0,"organization":"","debt":0.0000,"totalInvoiced":120000.0000,"totalRevenue":120000.0000,"totalPoint":0},{"id":13085874,"code":"KH000985","name":"Nguyễn Anh Phương","gender":true,"contactNumber":"0842757849","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-27T15:45:18.9200000","createdDate":"2021-09-27T15:45:13.2570000","type":0,"organization":"","debt":0.0000,"totalInvoiced":150000.0000,"totalRevenue":150000.0000,"totalPoint":1,"rewardPoint":1},{"id":13086162,"code":"KH000986","name":"Anh Việt - S2.10","gender":true,"contactNumber":"0962009427","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-27T16:00:37.2730000","createdDate":"2021-09-27T15:59:32.7300000","type":0,"organization":"","debt":0.0000,"totalInvoiced":60000.0000,"totalRevenue":60000.0000,"totalPoint":0},{"id":13088418,"code":"KH000988","name":"a khoa","contactNumber":"0915111996","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-27T18:09:17.6000000","createdDate":"2021-09-27T18:08:53.6530000","type":0,"organization":"","debt":0.0000,"totalInvoiced":380000.0000,"totalRevenue":380000.0000,"totalPoint":3,"rewardPoint":3},{"id":13100212,"code":"KH000994","name":"Chị Tuệ - Long Biên","gender":false,"contactNumber":"0966939923","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-28T16:39:18.0830000","createdDate":"2021-09-28T16:38:46.0670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":148000.0000,"totalRevenue":148000.0000,"totalPoint":1,"rewardPoint":1},{"id":13050992,"code":"KH000977","name":"Hà Trang-Vin OCP S2.11","contactNumber":"0966377034","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-29T17:52:58.0430000","createdDate":"2021-09-24T19:53:28.7530000","type":0,"organization":"","debt":0.0000,"totalInvoiced":305000.0000,"totalRevenue":305000.0000,"totalPoint":2,"rewardPoint":2},{"id":13037474,"code":"KH000972","name":"Chị Vy - S.1.01","gender":false,"contactNumber":"0962673031","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-29T20:21:11.8930000","createdDate":"2021-09-23T17:22:44.8530000","type":0,"organization":"","debt":-30000.0000,"totalInvoiced":754000.0000,"totalRevenue":754000.0000,"totalPoint":6,"rewardPoint":6},{"id":13120869,"code":"KH000996","name":"chị liễu - thôn 2 giang cao bát tràng","contactNumber":"0973039115","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-30T10:05:53.2170000","createdDate":"2021-09-30T10:05:49.9330000","type":0,"organization":"","debt":0.0000,"totalInvoiced":360000.0000,"totalRevenue":360000.0000,"totalPoint":3,"rewardPoint":3},{"id":13129157,"code":"KH000998","name":"c điệp","contactNumber":"0988757475","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-30T18:27:30.3800000","createdDate":"2021-09-30T18:27:27.0170000","type":0,"organization":"","debt":0.0000,"totalInvoiced":80000.0000,"totalRevenue":80000.0000,"totalPoint":0},{"id":13129595,"code":"KH001002","name":"chị huyền- long biên","contactNumber":"0378897518","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-09-30T19:17:37.4630000","createdDate":"2021-09-30T19:12:13.1470000","type":0,"organization":"","debt":0.0000,"totalInvoiced":322000.0000,"totalRevenue":322000.0000,"totalPoint":3,"rewardPoint":3},{"id":13149080,"code":"KH001008","name":"nguyễn duy toàn","contactNumber":"0812373456","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-02T10:36:36.4730000","createdDate":"2021-10-02T10:35:59.9400000","type":0,"organization":"","debt":0.0000,"totalInvoiced":100000.0000,"totalRevenue":100000.0000,"totalPoint":1,"rewardPoint":1},{"id":13149580,"code":"KH001009","name":"c huyên","contactNumber":"0365562231","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-02T10:59:59.0230000","createdDate":"2021-10-02T10:59:45.0800000","type":0,"organization":"","debt":0.0000,"totalInvoiced":150000.0000,"totalRevenue":150000.0000,"totalPoint":1,"rewardPoint":1},{"id":13149895,"code":"KH001010","name":"chị hà - cự khối, long biên","contactNumber":"0385718638","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-02T11:15:52.9370000","createdDate":"2021-10-02T11:15:48.7170000","type":0,"organization":"","debt":0.0000,"totalInvoiced":245000.0000,"totalRevenue":245000.0000,"totalPoint":1,"rewardPoint":1},{"id":13164898,"code":"KH001014","name":"Thủy- Cửu Việt 2","contactNumber":"0339424390","address":"","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","email":"","modifiedDate":"2021-10-03T12:56:11.2100000","createdDate":"2021-10-03T12:56:04.7670000","type":0,"organization":"","taxCode":"","comments":"","debt":0.0000,"totalInvoiced":155000.0000,"totalRevenue":155000.0000,"totalPoint":1,"rewardPoint":1},{"id":13174664,"code":"KH001015","name":"Chị Ninh- Sao Biển Vin OCP","contactNumber":"0914186186","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-04T09:06:40.5870000","createdDate":"2021-10-04T09:06:32.1670000","type":0,"organization":"","debt":0.0000,"totalInvoiced":210000.0000,"totalRevenue":210000.0000,"totalPoint":2,"rewardPoint":2},{"id":13175212,"code":"KH001016","name":"Hương","contactNumber":"0971502938","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-04T09:36:58.1930000","createdDate":"2021-10-04T09:35:41.4130000","type":0,"organization":"","debt":0.0000,"totalInvoiced":100000.0000,"totalRevenue":100000.0000,"totalPoint":1,"rewardPoint":1},{"id":13180280,"code":"KH001018","name":"chị thảo đào nguyên","contactNumber":"0963628649","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-04T14:09:37.2400000","createdDate":"2021-10-04T14:09:14.0700000","type":0,"organization":"","debt":0.0000,"totalInvoiced":110000.0000,"totalRevenue":110000.0000,"totalPoint":1,"rewardPoint":1},{"id":13181749,"code":"KH001019","name":"c thu","contactNumber":"0368860921","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-04T15:24:13.1770000","createdDate":"2021-10-04T15:23:18.5870000","type":0,"organization":"","debt":0.0000,"totalInvoiced":160000.0000,"totalRevenue":160000.0000,"totalPoint":1,"rewardPoint":1},{"id":13175354,"code":"KH001017","name":"Cường","contactNumber":"0979331438","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-04T15:55:59.5930000","createdDate":"2021-10-04T09:44:02.4070000","type":0,"organization":"","debt":0.0000,"totalInvoiced":625000.0000,"totalRevenue":625000.0000,"totalPoint":6,"rewardPoint":6},{"id":13192633,"code":"KH001021","name":"Chị Hoa - Thuận Quang","gender":false,"contactNumber":"0947782639","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-05T11:16:21.2530000","createdDate":"2021-10-05T11:16:15.8230000","type":0,"organization":"","debt":0.0000,"totalInvoiced":570000.0000,"totalRevenue":570000.0000,"totalPoint":5,"rewardPoint":5},{"id":13196269,"code":"KH001023","name":"Chị Trang - S1.01","gender":false,"contactNumber":"0961352292","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-05T15:03:56.1870000","createdDate":"2021-10-05T15:03:44.0770000","type":0,"organization":"","debt":0.0000,"totalInvoiced":555000.0000,"totalRevenue":555000.0000,"totalPoint":5,"rewardPoint":5},{"id":13197052,"code":"KH001024","name":"NGUYỄN ANH TUẤN KĐT ĐẶNG XÁ","contactNumber":"0963902829","address":"","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-05T15:41:36.8570000","createdDate":"2021-10-05T15:41:31.8230000","type":0,"organization":"","debt":0.0000,"totalInvoiced":100000.0000,"totalRevenue":100000.0000,"totalPoint":0},{"id":13200516,"code":"KH001027","name":"Anh Cường - S1.10","gender":true,"contactNumber":"0928668505","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-05T19:44:53.4730000","createdDate":"2021-10-05T19:42:46.2770000","type":0,"organization":"","debt":0.0000,"totalInvoiced":190000.0000,"totalRevenue":190000.0000,"totalPoint":1,"rewardPoint":1},{"id":13201452,"code":"KH001028","name":"Hà - Trâu Quỳ","gender":false,"contactNumber":"0355838671","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-05T21:17:41.0430000","createdDate":"2021-10-05T21:17:30.0170000","type":0,"organization":"","debt":0.0000,"totalInvoiced":545000.0000,"totalRevenue":545000.0000,"totalPoint":3,"rewardPoint":3},{"id":13217501,"code":"KH001033","name":"Chị Ngọc Anh - S2.10","gender":false,"contactNumber":"0988645656","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-06T18:49:27.2970000","createdDate":"2021-10-06T18:48:25.5330000","type":0,"organization":"","debt":0.0000,"totalInvoiced":419000.0000,"totalRevenue":419000.0000,"totalPoint":2,"rewardPoint":2},{"id":13221485,"code":"KH001035","name":"anh Thắng - Hoàn Kiếm","gender":true,"contactNumber":"0906043810","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-07T08:25:53.3500000","createdDate":"2021-10-07T08:25:50.1700000","type":0,"organization":"","debt":0.0000,"totalInvoiced":305000.0000,"totalRevenue":305000.0000,"totalPoint":3,"rewardPoint":3},{"id":13131915,"code":"KH001003","name":"Chị ở Vin S2.11","contactNumber":"0349726838","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-07T08:33:59.0700000","createdDate":"2021-09-30T23:31:50.2500000","type":0,"organization":"","debt":550000.0000,"totalInvoiced":900000.0000,"totalRevenue":900000.0000,"totalPoint":4,"rewardPoint":4},{"id":13233379,"code":"KH001038","name":"Anh Duy-Vin OCP S2.10","contactNumber":"0355536588","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-07T18:39:45.3000000","createdDate":"2021-10-07T18:32:22.7730000","type":0,"organization":"","debt":0.0000,"totalInvoiced":95000.0000,"totalRevenue":95000.0000,"totalPoint":0},{"id":9658316,"code":"KH000357","name":"anh Đạt-Đông Dư","gender":true,"contactNumber":"0986084891","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-07T19:24:34.3000000","createdDate":"2021-02-25T12:27:09.4430000","type":0,"organization":"","comments":"hẹn siêu âm lần 2 miễn phí","debt":0.0000,"totalInvoiced":500000.0000,"totalRevenue":500000.0000,"totalPoint":3,"rewardPoint":3},{"id":13234754,"code":"KH001040","name":"Chị Thủy-Vin OCP S1.11","contactNumber":"09830223295","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-07T20:39:52.4500000","createdDate":"2021-10-07T20:37:29.9130000","type":0,"organization":"","debt":0.0000,"totalInvoiced":250000.0000,"totalRevenue":250000.0000,"totalPoint":2,"rewardPoint":2},{"id":13238313,"code":"KH001041","name":"đỗ thị hải","contactNumber":"0338795556","address":"an đào a","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-08T09:39:59.4630000","createdDate":"2021-10-08T09:39:43.5030000","type":0,"organization":"","debt":0.0000,"totalInvoiced":170000.0000,"totalRevenue":170000.0000,"totalPoint":1,"rewardPoint":1},{"id":13239780,"code":"KH001042","name":"Anh Thường - D12- Đặng Xá","gender":true,"contactNumber":"0987774571","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-08T10:47:33.7230000","createdDate":"2021-10-08T10:46:47.4900000","type":0,"organization":"","debt":0.0000,"totalInvoiced":100000.0000,"totalRevenue":100000.0000,"totalPoint":0},{"id":13216233,"code":"KH001031","name":"Chủ cún bị ve","contactNumber":"0932224883","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-09T18:58:52.3430000","createdDate":"2021-10-06T17:19:48.5870000","type":0,"organization":"","debt":0.0000,"totalInvoiced":575000.0000,"totalRevenue":575000.0000,"totalPoint":4,"rewardPoint":4},{"id":10215425,"code":"KH000519","name":"nguyễn khắc ngọc","gender":true,"contactNumber":"0398187517","address":"67 an đào","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-10T15:27:59.2830000","createdDate":"2021-03-23T22:23:57.2800000","type":0,"organization":"","debt":0.0000,"totalInvoiced":1202000.0000,"totalRevenue":1202000.0000,"totalPoint":11,"rewardPoint":11},{"id":13301868,"code":"KH001046","name":"Thảo - S2.08","contactNumber":"0941708888","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-11T16:29:15.7900000","createdDate":"2021-10-11T16:29:09.1370000","type":0,"organization":"","debt":0.0000,"totalInvoiced":120000.0000,"totalRevenue":120000.0000,"totalPoint":1,"rewardPoint":1},{"id":10245422,"code":"KH000526","name":"trang-Vin OCP S1.06","contactNumber":"0384164092","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-12T17:15:02.1870000","createdDate":"2021-03-25T15:10:13.1070000","type":0,"organization":"","debt":0.0000,"totalInvoiced":150000.0000,"totalRevenue":150000.0000,"totalPoint":1,"rewardPoint":1},{"id":13319588,"code":"KH001051","name":"Anh An Đào C","contactNumber":"0975734568","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-12T18:07:56.8930000","createdDate":"2021-10-12T18:05:22.0830000","type":0,"organization":"","debt":10000.0000,"totalInvoiced":50000.0000,"totalRevenue":50000.0000,"totalPoint":0},{"id":13343846,"code":"KH001056","name":"Anh Tùng - Gia Lâm","gender":true,"contactNumber":"0966240293","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-14T11:21:00.9400000","createdDate":"2021-10-14T11:20:33.0130000","type":0,"organization":"","debt":0.0000,"totalInvoiced":125000.0000,"totalRevenue":125000.0000,"totalPoint":0},{"id":13344084,"code":"KH001057","name":"Anh Tuấn Anh - S2.05","contactNumber":"0948696456","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-14T11:32:05.1170000","createdDate":"2021-10-14T11:31:56.1170000","type":0,"organization":"","debt":0.0000,"totalInvoiced":104000.0000,"totalRevenue":104000.0000,"totalPoint":1,"rewardPoint":1},{"id":13348245,"code":"KH001058","name":"Chị Trang- Vin OCP S2.16","contactNumber":"0968112984","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-14T15:48:22.0800000","createdDate":"2021-10-14T15:28:58.9730000","type":0,"organization":"","debt":0.0000,"totalInvoiced":365000.0000,"totalRevenue":365000.0000,"totalPoint":3,"rewardPoint":3},{"id":8818866,"code":"KH000275","name":"Anh Khang-Lê Trọng Tấn","contactNumber":"0969633996","address":"Số nhà 17 ngach 5 ngõ 8 lê trong tấn hà đông","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-15T08:26:55.3270000","createdDate":"2021-01-19T11:46:42.1570000","type":0,"organization":"","debt":0.0000,"totalInvoiced":4370000.0000,"totalRevenue":4370000.0000,"totalPoint":23,"rewardPoint":23},{"id":13364442,"code":"KH001062","name":"Huy - S2.06","gender":true,"contactNumber":"0963236961","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-15T15:15:04.3830000","createdDate":"2021-10-15T15:15:02.5530000","type":0,"organization":"","debt":0.0000,"totalInvoiced":180000.0000,"totalRevenue":180000.0000,"totalPoint":1,"rewardPoint":1},{"id":13367825,"code":"KH001063","name":"Chú Thủy - Dương Xá","gender":true,"contactNumber":"0988204469","retailerId":696740,"branchId":57644,"locationName":"","wardName":"","modifiedDate":"2021-10-15T17:24:54.3430000","createdDate":"2021-10-15T17:24:52.0270000","type":0,"organization":"","debt":0.0000,"totalInvoiced":100000.0000,"totalRevenue":100000.0000,"totalPoint":0}]';

        return json_decode($rs);
    }

    /**
     * Sanitize requested person data and return the clean array.
     */
    private function sanitizeRequestedPersonData(array $data): array
    {
        if (
            array_key_exists('organization_id', $data)
            && empty($data['organization_id'])
        ) {
            $data['organization_id'] = null;
        }

        if (isset($data['contact_numbers'])) {
            $data['contact_numbers'] = collect($data['contact_numbers'])->filter(fn($number) => ! is_null($number['value']))->toArray();
        }

        return $data;
    }
}
